(window.webpackJsonp=window.webpackJsonp||[]).push([[58],{541:function(e,t,n){"use strict";function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var o,a,s=[],r=!0,i=!1;try{for(n=n.call(e);!(r=(o=n.next()).done)&&(s.push(o.value),!t||s.length!==t);r=!0);}catch(c){i=!0,a=c}finally{try{r||null==n.return||n.return()}finally{if(i)throw a}}return s}(e,t)||a(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){if(e){if("string"===typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function r(e,t){var n=t.target.dataset.targetType,o="personal"===n?"moderator":"personal";t.target.classList.toggle("active"),e.getElementsByClassName("".concat(o,"-template-button"))[0].classList.toggle("active"),e.getElementsByClassName("".concat(n,"-responses-container"))[0].classList.toggle("hidden"),e.getElementsByClassName("".concat(o,"-responses-container"))[0].classList.toggle("hidden")}n.r(t);function i(e,t){return 0===e.length&&"personal_comment"===t?'\n<div class="mod-response-wrapper mod-response-wrapper-empty">\n  <p>\ud83e\udd14... It looks like you don\'t have any templates yet.</p>\n</div>\n':"personal_comment"===t?e.map((function(e){return'\n          <div class="mod-response-wrapper flex mb-4">\n            <div class="flex-1">\n              <h4>'.concat(e.title,"</h4>\n              <p>").concat(e.content,'</p>\n            </div>\n            <div class="pl-2">\n              <button class="crayons-btn crayons-btn--secondary crayons-btn--s insert-template-button" type="button" data-content="').concat(e.content,'">Insert</button>\n            </div>\n          </div>\n        ')})).join(""):"mod_comment"===t?e.map((function(e){return'\n            <div class="mod-response-wrapper mb-4 flex">\n              <div class="flex-1">\n                <h4>'.concat(e.title,"</h4>\n                <p>").concat(e.content,'</p>\n              </div>\n              <div class="flex flex-nowrap pl-2">\n                <button class="crayons-btn crayons-btn--s crayons-btn--secondary moderator-submit-button m-1" type="submit" data-response-template-id="').concat(e.id,'">Send as Mod</button>\n                <button class="crayons-btn crayons-btn--s crayons-btn--outlined insert-template-button m-1" type="button" data-content="').concat(e.content,'">Insert</button>\n              </div>\n            </div>\n          ')})).join(""):"Error \ud83d\ude1e"}function c(e){var t=e.getElementsByClassName("response-templates-container")[0],n="new_comment"!==e.id&&!e.id.includes("edit_comment"),o=Array.from(t.getElementsByClassName("insert-template-button")),a=Array.from(t.getElementsByClassName("moderator-submit-button"));o.forEach((function(e){e.addEventListener("click",(function(e){var n=e.target.dataset.content,o=e.target.form.querySelector(".comment-textarea:not([role=combobox])");(null===o.value||""===o.value||confirm("Are you sure you want to replace your current comment draft?"))&&(o.value=n,o.dispatchEvent(new Event("input",{target:o})),o.focus(),t.classList.toggle("hidden"))}))})),a.forEach((function(e){e.addEventListener("click",(function(e){var t,o,a;e.preventDefault(),confirm("\nAre you sure you want to submit this comment as Sloan?\n\nIt will be sent immediately and users will be notified.\n\nMake sure this is the appropriate comment for the situation.\n\nThis action is not reversible.")&&(t=e.target.dataset.responseTemplateId,o=n,a=document.getElementById("comment_commentable_id").value,fetch("/comments/moderator_create",{method:"POST",headers:{Accept:"application/json","X-CSRF-Token":window.csrfToken,"Content-Type":"application/json"},body:JSON.stringify({response_template:{id:t},comment:{body_markdown:"",commentable_id:a,commentable_type:"Article",parent_id:o}})}).then((function(e){return e.json()})).then((function(e){"created"===e.status?window.location.pathname=e.path:"comment already exists"===e.status?alert("This comment already exists."):"error"===e.error&&alert("There was a problem submitting this comment: ".concat(e.status))})))}))}))}function l(e,t){var n=document.getElementById(t),s=[["personal_comment","personal-responses-container"],["mod_comment","moderator-responses-container"]];fetch("/response_templates",{method:"GET",headers:{Accept:"application/json","X-CSRF-Token":window.csrfToken,"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){var t;n.querySelector("img.loading-img").classList.toggle("hidden");var r,l=document.getElementById("response-templates-data"),d=function(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=a(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var o=0,s=function(){};return{s:s,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){c=!0,r=e},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw r}}}}(s);try{for(d.s();!(r=d.n()).done;){var u=o(r.value,2),p=u[0],f=u[1];if("undefined"!=typeof e[p]){var y=n.getElementsByClassName(f)[0];y.innerHTML=i(e[p],p),t?(l.classList.add(p),y.classList.add("hidden"),m(n)):(t=y,y.classList.remove("hidden"),l.classList.add(p)),l.innerHTML=y.parentElement.innerHTML}}}catch(b){d.e(b)}finally{d.f()}c(n)}))}function m(e){var t=e.getElementsByClassName("personal-template-button")[0],n=e.getElementsByClassName("moderator-template-button")[0];t.addEventListener("click",(function(t){r(e,t)})),t.classList.remove("hidden"),n.addEventListener("click",(function(t){r(e,t)})),n.classList.remove("hidden")}function d(e){var t=e.getElementsByClassName("response-templates-container")[0],n=document.getElementById("response-templates-data"),o=""!==n.innerHTML;t.classList.toggle("hidden");var a=t.classList.contains("hidden");o&&!a?(!function(e){e.innerHTML=document.getElementById("response-templates-data").innerHTML}(t),c(e)):o||a||function(e){e.querySelector("img.loading-img").classList.toggle("hidden"),l(0,e.id)}(e),n.classList.contains("personal_comment")&&n.classList.contains("mod_comment")?(e.getElementsByClassName("moderator-template-button")[0].classList.remove("hidden"),e.getElementsByClassName("personal-template-button")[0].classList.remove("hidden"),m(e)):(e.getElementsByClassName("moderator-template-button")[0].classList.add("hidden"),e.getElementsByClassName("personal-template-button")[0].classList.add("hidden"))}function u(e){var t=e.getElementsByClassName("response-templates-button")[0];t&&(t.addEventListener("click",(function(){d(e)})),t.dataset.hasListener="true")}function p(){var e,t,n,o=document.body.dataset.userStatus,a=document.getElementsByClassName("comment-form")[0];document.getElementById("response-templates-data")&&("logged-out"===o&&(null===(n=document.getElementsByClassName("response-templates-button")[0])||void 0===n||n.addEventListener("click",showLoginModal)),a&&"false"===a.getElementsByClassName("response-templates-button")[0].dataset.hasListener&&u(a),e=new MutationObserver((function(e){var t=Array.from(e[0].addedNodes).filter((function(e){return"FORM"===e.nodeName}));t.length>0&&u(t[0])})),(t=document.getElementById("comment-trees-container"))&&e.observe(t,{childList:!0,subtree:!0}),window.addEventListener("beforeunload",(function(){e.disconnect()})),window.InstantClick.on("change",(function(){e.disconnect()})))}window.InstantClick.on("change",(function(){p()})),p()}},[[541,110]]]);
//# sourceMappingURL=responseTemplates-3f0c817e6570702c7793.chunk.js.map